language: ruby
rvm:
  - 2.5
cache: bundler
sudo: false
services:
  - docker

before_install:
  - docker-compose pull
  - docker-compose build
  - docker ps

  # setup testing environment
  - docker-compose run --rm -e RAILS_ENV=test --entrypoint="bundle install" zoo_stats
  - docker-compose run --rm -e RAILS_ENV=test --entrypoint="bundle exec rake db:setup" zoo_stats

script:
  - docker-compose run -T --rm -e RAILS_ENV=test --entrypoint="bundle exec rspec" zoo_stats
